<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FocusFlow Audio</title>
</head>
<body>
    <script>
        // Audio context for playing sounds
        let audioContext = null;
        
        // Initialize audio context
        function initAudioContext() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            return audioContext;
        }
        
        // Listen for messages from background script
        chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
            if (message.action === 'playSound') {
                playNotificationSound(message.soundType, message.volume || 0.7);
                sendResponse({ success: true });
            }
        });
        
        // Play notification sound based on type
        function playNotificationSound(soundType, volume) {
            const ctx = initAudioContext();
            
            let frequency1, frequency2, duration;
            
            switch (soundType) {
                case 'shortBreak':
                    // Work → Short Break: gentle, relaxing
                    frequency1 = 523.25; // C5
                    frequency2 = 659.25; // E5
                    duration = 0.5;
                    break;
                    
                case 'longBreak':
                    // Work → Long Break: deeper, more prominent
                    frequency1 = 523.25; // C5
                    frequency2 = 392.00; // G4
                    duration = 0.8;
                    break;
                    
                case 'work':
                    // Break → Work: energetic, motivating
                    frequency1 = 659.25; // E5
                    frequency2 = 783.99; // G5
                    duration = 0.4;
                    break;
                    
                default:
                    // Default sound
                    frequency1 = 523.25; // C5
                    frequency2 = 659.25; // E5
                    duration = 0.5;
            }
            
            playChime(ctx, frequency1, frequency2, duration, volume);
        }
        
        // Create and play a chime sound
        function playChime(audioContext, freq1, freq2, duration, volume) {
            const gainNode = audioContext.createGain();
            const oscillator1 = audioContext.createOscillator();
            const oscillator2 = audioContext.createOscillator();
            
            // Configure oscillators
            oscillator1.frequency.setValueAtTime(freq1, audioContext.currentTime);
            oscillator1.type = 'sine';
            
            oscillator2.frequency.setValueAtTime(freq2, audioContext.currentTime);
            oscillator2.type = 'sine';
            
            // Configure gain (volume with fade out)
            gainNode.gain.setValueAtTime(volume * 0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
            
            // Connect nodes
            oscillator1.connect(gainNode);
            oscillator2.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            // Play sound
            oscillator1.start(audioContext.currentTime);
            oscillator2.start(audioContext.currentTime);
            
            oscillator1.stop(audioContext.currentTime + duration);
            oscillator2.stop(audioContext.currentTime + duration);
        }
    </script>
</body>
</html> 